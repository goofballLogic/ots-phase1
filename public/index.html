<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#000000" />
  <meta name="description" content="Web site created using create-react-app" />
  <link rel="apple-touch-icon" href="%PUBLIC_URL%/logo192.png" />
  <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
  <title>Dev@OpenTeamSpace</title>
  <script src="https://apis.google.com/js/platform.js"></script>
  <meta name="google-signin-client_id"
    content="60961398610-mgilh4kuns7trtq8vpjm4iob683ls5il.apps.googleusercontent.com">
</head>

<body>
  <noscript>You need to enable JavaScript to run this app.</noscript>
  <div id="root"></div>
  <div id="gapi">
    <div class="g-signin2"></div>
  </div>
  <script>
    window.gapi.load("auth2", function () {
      const auth2 = window.gapi.auth2.init();

      function buildUser() {
        const isSignedIn = auth2.isSignedIn.get();
        if (!isSignedIn) return null;
        const basicProfile = auth2.currentUser.get()?.getBasicProfile();
        if (!basicProfile) return null;
        return {
          id: basicProfile.getId(),
          name: basicProfile.getName(),
          email: basicProfile.getEmail()
        };
      }

      function dispatchGAPIUserUpdate() {
        document.dispatchEvent(new CustomEvent("gapi-user", { detail: buildUser() }));
      }

      function signOutUser() {
        auth2.signOut();
      }

      auth2.isSignedIn.listen(() => console.log("Sign in changed") || dispatchGAPIUserUpdate());
      document.addEventListener("request-user", dispatchGAPIUserUpdate);
      document.addEventListener("sign-out", signOutUser);
      dispatchGAPIUserUpdate();

    });
  </script>
</body>

</html>